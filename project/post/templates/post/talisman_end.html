<!DOCTYPE html> <!--페이지 1-->
{% load static %}
<html>
    <head>
            <meta charset="utf-8" />    
            <link rel="stylesheet" type="text/css" href="{% static 'css/main/talisman_end.css'%}"/>
            <meta name="viewport" content="width=device-width, initial-scale=1">
            <style>
              @font-face {
                  font-family: 'GamtanRoadBatang';
                  src: url("{% static 'font/GamtanRoad_Batang_TTF/batang_Regular.ttf' %}") format('truetype');
                  font-weight: normal;
                  font-style: normal;
              }
      
              @font-face {
                  font-family: 'GamtanRoadBatang';
                  src: url("{% static 'font/GamtanRoad_Batang_TTF/batang_Bold.ttf' %}") format('truetype');
                  font-weight: bold;
                  font-style: normal;
              }
      
              @font-face {
                  font-family: 'GamtanRoadBatang';
                  src: url("{% static 'font/GamtanRoad_Batang_TTF/batang_Thin.ttf' %}") format('truetype');
                  font-weight: 100;
                  font-style: normal;
              }
              @font-face {
                  font-family: 'GamtanRoadDotum';
                  src: url("{% static 'font/GamtanRoad_Dotum_TTF/Dotum_Regular.ttf' %}") format('truetype');
                  font-weight: normal;
                  font-style: normal;
              }
      
              @font-face {
                  font-family: 'GamtanRoadDotum';
                  src: url("{% static 'font/GamtanRoad_Dotum_TTF/Dotum_Bold.ttf' %}") format('truetype');
                  font-weight: bold;
                  font-style: normal;
              }
      
              @font-face {
                  font-family: 'GamtanRoadDotum';
                  src: url("{% static 'font/GamtanRoad_Dotum_TTF/Dotum_Thin.ttf' %}") format('truetype');
                  font-weight: 100;
                  font-style: normal;
              }
              @font-face {
                  font-family: 'GamtanRoadGamtan';
                  src: url("{% static 'font/GamtanRoad_Gamtan_TTF/gamtan.ttf' %}") format('truetype');
                  font-weight: normal;
                  font-style: normal;
              }
              @font-face {
                  font-family: 'GamtanRoadTantan';
                  src: url("{% static 'font/GamtanRoad_Tantan_TTF/tantan.ttf' %}") format('truetype');
                  font-weight: normal;
                  font-style: normal;
              }
      
          </style>
        <title>Page Title</title>
         
        <style>
          @font-face {
              font-family: 'GamtanRoadBatang';
              src: url("{% static 'font/GamtanRoad_Batang_TTF/batang_Regular.ttf' %}") format('truetype');
              font-weight: normal;
              font-style: normal;
          }
  
          @font-face {
              font-family: 'GamtanRoadBatang';
              src: url("{% static 'font/GamtanRoad_Batang_TTF/batang_Bold.ttf' %}") format('truetype');
              font-weight: bold;
              font-style: normal;
          }
  
          @font-face {
              font-family: 'GamtanRoadBatang';
              src: url("{% static 'font/GamtanRoad_Batang_TTF/batang_Thin.ttf' %}") format('truetype');
              font-weight: 100;
              font-style: normal;
          }
          @font-face {
              font-family: 'GamtanRoadDotum';
              src: url("{% static 'font/GamtanRoad_Dotum_TTF/Dotum_Regular.ttf' %}") format('truetype');
              font-weight: normal;
              font-style: normal;
          }
  
          @font-face {
              font-family: 'GamtanRoadDotum';
              src: url("{% static 'font/GamtanRoad_Dotum_TTF/Dotum_Bold.ttf' %}") format('truetype');
              font-weight: bold;
              font-style: normal;
          }
  
          @font-face {
              font-family: 'GamtanRoadDotum';
              src: url("{% static 'font/GamtanRoad_Dotum_TTF/Dotum_Thin.ttf' %}") format('truetype');
              font-weight: 100;
              font-style: normal;
          }
          @font-face {
              font-family: 'GamtanRoadGamtan';
              src: url("{% static 'font/GamtanRoad_Gamtan_TTF/gamtan.ttf' %}") format('truetype');
              font-weight: normal;
              font-style: normal;
          }
          @font-face {
              font-family: 'GamtanRoadTantan';
              src: url("{% static 'font/GamtanRoad_Tantan_TTF/tantan.ttf' %}") format('truetype');
              font-weight: normal;
              font-style: normal;
          }
  
      </style>
    </head>

<body>
  <div class = "screen">
    <div class = "topnav">
        <a href="{% url "main:mainpage" %}">
            <div class = "onjung">온정</div>
        </a>
    </div> <!--topnav 닫는 태그-->

      <div id="acoong">
        {% if category == "1" %}
        <div class="column">
          <img class="health" alt="안뜸" src="{%static 'images/mainpage_img/health.png'%}"/>
        <div id="nemo">
          <img class="icon-place" alt="안뜸" src="{%static 'images/talisman/t1.png'%}"/>
        </div><!--부적 데이터가 필요한 공간!-->
        </div>

        {% elif category == "2" %}
       <div class="column">
          <img class="health" alt="안뜸" src="{%static 'images/mainpage_img/love.png'%}"/>
          <div id="nemo">
            <img class="icon-place" alt="안뜸" src="{%static 'images/talisman/t2.png'%}"/>
          </div><!--부적 데이터가 필요한 공간!-->
        </div> 

        {% elif category == "3" %}
        <div class="column">
          <img class="health" alt="안뜸" src="{%static 'images/mainpage_img/money.png'%}"/>
          <div id="nemo">
            <img class="icon-place" alt="안뜸" src="{%static 'images/talisman/t3.png'%}"/>
          </div><!--부적 데이터가 필요한 공간!-->
        </div>

        {% elif category == "4" %}
        <div class="column">
          <img class="health" alt="안뜸" src="{%static 'images/mainpage_img/work.png'%}"/>
          <div id="nemo">
            <img class="icon-place" alt="안뜸" src="{%static 'images/talisman/t4.png'%}"/>
          </div><!--부적 데이터가 필요한 공간!-->
        </div>
        {% elif category == "5" %}
        <div class="column">
          <img class="health" alt="안뜸" src="{%static 'images/mainpage_img/study.png'%}"/>
          <div id="nemo">
            <img class="icon-place" alt="안뜸" src="{%static 'images/talisman/t5.png'%}"/>
          </div><!--부적 데이터가 필요한 공간!-->
        </div> 

        {% endif %}
      </div>

      <div id="three_buttons">
      
        <div id="btn" class="btn1">
          <a href="{% url "post:talisman" %}">
          <img id="btn_img" src="https://ifh.cc/g/5J2MVJ.png">
          <p id="btn_text">다시 제작하기</p>
        </a>
        </div>

        {% if category == "1"%}
        <div id="btn" class="btn2">
          <img id="btn_img" src="https://ifh.cc/g/56JHOb.png">
          <p id="btn_text"><a href="{% static 'images/talisman/t1.png' %}" download>부적 저장하기</a></p>
        </div>
        {% elif category == "2" %}
        <div id="btn" class="btn2">
          <img id="btn_img" src="https://ifh.cc/g/56JHOb.png">
          <p id="btn_text"><a href="{% static 'images/talisman/t2.png' %}" download>부적 저장하기</a></p>
        </div>
        {% elif category == "3" %}
        <div id="btn" class="btn2">
          <img id="btn_img" src="https://ifh.cc/g/56JHOb.png">
          <p id="btn_text"><a href="{% static 'images/talisman/t3.png' %}" download>부적 저장하기</a></p>
        </div>
        {% elif category == "4" %}
        <div id="btn" class="btn2">
          <img id="btn_img" src="https://ifh.cc/g/56JHOb.png">
          <p id="btn_text"><a href="{% static 'images/talisman/t4.png' %}" download>부적 저장하기</a></p>
        </div>
        {% elif category == "5" %}
        <div id="btn" class="btn2">
          <img id="btn_img" src="https://ifh.cc/g/56JHOb.png">
          <p id="btn_text"><a href="{% static 'images/talisman/t5.png' %}" download>부적 저장하기</a></p>
        </div>
        {% endif %}
        

        <div id="btn" class="btn3">
          <a href="{% url "main:mainpage" %}">
          <img id="btn_img" src="https://ifh.cc/g/5bDcgY.png">
          <p id="btn_text">홈으로 돌아가기</p>
          </a>
        </div>

      </div> <!—screen 닫는 태그—>


      <script>
        let backgroundAudio;

        // 페이지가 언로드되기 전에 오디오 상태를 저장합니다.
        window.addEventListener('beforeunload', () => {
            if (backgroundAudio) {
                localStorage.setItem('audioCurrentTime', backgroundAudio.currentTime);
                localStorage.setItem('isAudioPlaying', !backgroundAudio.paused);
            }
        });
        
        // 페이지 로드 시 오디오 객체를 생성하고 상태를 복원합니다.
        document.addEventListener('DOMContentLoaded', () => {
            backgroundAudio = new Audio("/static/images/mainpage_img/perfectbgm.mp3"); // 적절한 경로로 수정하세요.
            backgroundAudio.loop = true;
        
            const toggleButton = document.querySelector('.img-bgm');
        
            // 로컬 스토리지에서 저장된 재생 시간을 가져와 설정합니다.
            const audioCurrentTime = localStorage.getItem('audioCurrentTime');
            if (audioCurrentTime) {
                backgroundAudio.currentTime = parseFloat(audioCurrentTime);
            }
        
            // 로컬 스토리지에서 가져온 상태에 따라 오디오를 재생 또는 정지합니다.
            const isAudioPlaying = localStorage.getItem('isAudioPlaying') === 'true';
            if (isAudioPlaying) {
                backgroundAudio.play();
                toggleButton.src = "/static/images/mainpage_img/Frame 159.png"; // 브금이 재생될 때의 이미지
            } else {
                toggleButton.src = "/static/images/mainpage_img/img-bgm.png"; // 브금이 정지될 때의 이미지
            }
        
            // 클릭 이벤트를 추가하여 오디오 재생 및 정지 기능을 구현합니다.
            toggleButton.addEventListener('click', () => {
                if (backgroundAudio.paused) {
                    backgroundAudio.play();
                    toggleButton.src = "/static/images/mainpage_img/Frame 159.png"; // 브금이 재생될 때의 이미지
                    localStorage.setItem('isAudioPlaying', 'true'); // 오디오 상태를 로컬 스토리지에 저장합니다.
                } else {
                    backgroundAudio.pause();
                    toggleButton.src = "/static/images/mainpage_img/img-bgm.png"; // 브금이 정지될 때의 이미지
                    localStorage.setItem('isAudioPlaying', 'false'); // 오디오 상태를 로컬 스토리지에 저장합니다.
                }
            });
        });
    </script>
    </body>